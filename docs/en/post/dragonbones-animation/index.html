<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Animation with Dragon Bones - Cocos2d-x basics</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Animation with Dragon Bones" />
<meta property="og:description" content="There are many variants to create a skeletal animation but almost all of them are paid and so not available for educational purposes. In this article we&rsquo;ll work with Dragon Bones, that&rsquo;s a free, but a bit weird tool.
The Dragon Bones has decent functionality and it&rsquo;s free. To be presise the editor itself is free as in beer (closed sources) but the code for integrating models into cocos2d-x is distributed under MIT license." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://beardog-ukr.github.io/cocos2dx-examples/en/post/dragonbones-animation/" />
<meta property="article:published_time" content="2020-09-26T07:30:25+03:00" />
<meta property="article:modified_time" content="2020-09-26T07:30:25+03:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Animation with Dragon Bones"/>
<meta name="twitter:description" content="There are many variants to create a skeletal animation but almost all of them are paid and so not available for educational purposes. In this article we&rsquo;ll work with Dragon Bones, that&rsquo;s a free, but a bit weird tool.
The Dragon Bones has decent functionality and it&rsquo;s free. To be presise the editor itself is free as in beer (closed sources) but the code for integrating models into cocos2d-x is distributed under MIT license."/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://beardog-ukr.github.io/cocos2dx-examples/en/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://beardog-ukr.github.io/cocos2dx-examples/en/css/main.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<script src="https://beardog-ukr.github.io/cocos2dx-examples/en/js/main.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title"><a href="https://beardog-ukr.github.io/cocos2dx-examples/en/">Cocos2d-x basics</a></h1>
	<div class="site-description"><h2>Some articles about Cocos2d-x framework</h2><nav class="nav social">
			<ul class="flat"><a href="https://github.com/beardog-ukr/cocos2dx-examples" title="Github"><i data-feather="github"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/cocos2dx-examples/en/">Recent</a>
			</li>
			
			<li>
				<a href="/cocos2dx-examples/en/posts">All</a>
			</li>
			
			<li>
				<a href="/cocos2dx-examples/en/about">About</a>
			</li>
			
			<li>
				<a href="/cocos2dx-examples/en/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">Animation with Dragon Bones</h1>
			<div class="meta">Posted at &mdash; Sep 26, 2020</div>
		</div>

		<div class="markdown">
			<p>There are <a href="https://www.slant.co/options/15725/alternatives/~dragonbones-pro-alternatives">many variants</a> to create a <a href="https://en.wikipedia.org/wiki/Skeletal_animation">skeletal animation</a> but almost all of them are paid and so not available for educational purposes. In this article we&rsquo;ll work with <a href="https://dragonbones.github.io/en/index.html">Dragon Bones</a>, that&rsquo;s a free, but a bit weird tool.</p>
<p>The <em>Dragon Bones</em> has decent functionality and it&rsquo;s free. To be presise the editor itself is free as in beer (closed sources) but the code for integrating models into <em>cocos2d-x</em> is distributed under MIT license.</p>
<p>On the bad side, it&rsquo;s a bit unstable. For example, few months ago it was hard to download the editor from <a href="https://dragonbones.github.io/en/download.html">official page</a> because it got some issues with modern browsers. There is a code for integration DB files into <em>cocos2d-x</em> in the <a href="https://github.com/DragonBones/DragonBonesCPP/tree/master/Cocos2DX_3.x">official repository</a>, but it&rsquo;s obsolete and will cause some compilation errors. I&rsquo;d recommend to use <a href="https://github.com/beardog-ukr/dragonbones-cocos2dx-v4-demo">this</a> repository because it has all tweaks required for Cocos2d V4.</p>
<p>Anyway, after getting it up and running the <em>Dragon Bones</em> editor starts to work seamlessly and allows you to create a really cool things like this one:</p>
<figure>
    <img src="/cocos2dx-examples/en/post/dragon-bones-img/dragon_bones_mecha.gif"/> <figcaption>
            <h4>Example CoreElementGame from official repo</h4>
        </figcaption>
</figure>

<p>Just note, this mecha is really a 2d picture, you can see it <a href="https://github.com/beardog-ukr/dragonbones-cocos2dx-v4-demo/blob/master/DemoProj/Resources/mecha_1502b/mecha_1502b_tex.png">here</a> stripped into parts.</p>
<p>For our example we&rsquo;ll take medieval persons from <a href="https://jordan97.itch.io/cartoon-character-kit">this free pack</a> and will give them some <a href="https://krukowski.itch.io/free-weapons">swords</a> and <a href="https://kaylousberg.itch.io/gun-assets">guns</a>.</p>
<p>Here I&rsquo;m not going to tell how to create the models and animations. It&rsquo;s quite complicated and really that&rsquo;s more for graphical designers and not for software developers. There is a good <a href="http://getting-started-dragonbones.blogspot.com/2017/01/dragonbones-tutorial-part-i.html">tutorial here</a>, and <a href="https://habr.com/ru/post/350254/">here</a>, and <a href="https://topic.alibabacloud.com/a/a-tutorial-on-using-the-dragonbones-of-the-skeleton-animation-tool_8_8_31057239.html">here</a>.</p>
<p>Anyway, after you create a model and export it from <em>Dragon Bones</em> to <em>Cocod2d</em> it will give you <a href="https://github.com/beardog-ukr/cocos2dx-examples/tree/master/examples/DragonBonesImport/Resources/db_export">three files</a>: two JSONs defining the model and one image with all resources.</p>
<p>Import into the program is similar to opening <em>plist</em> files:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#719e07">#include</span> <span style="color:#719e07">&#34;dragonBones/cocos2dx/CCDragonBonesHeaders.h&#34;</span><span style="color:#719e07">
</span><span style="color:#719e07"></span>
dragonBones<span style="color:#719e07">::</span>CCFactory<span style="color:#719e07">*</span> factory <span style="color:#719e07">=</span> dragonBones<span style="color:#719e07">::</span>CCFactory<span style="color:#719e07">::</span>getFactory();
factory<span style="color:#719e07">-&gt;</span>loadDragonBonesData(<span style="color:#2aa198">&#34;db_export/BlueWizard_ske.json&#34;</span>, <span style="color:#2aa198">&#34;BlueWizard&#34;</span>);
factory<span style="color:#719e07">-&gt;</span>loadTextureAtlasData(<span style="color:#2aa198">&#34;db_export/BlueWizard_tex.json&#34;</span>, <span style="color:#2aa198">&#34;BlueWizard&#34;</span>);

dragonBones<span style="color:#719e07">::</span>CCArmatureDisplay<span style="color:#719e07">*</span> wizard <span style="color:#719e07">=</span> factory<span style="color:#719e07">-&gt;</span>buildArmatureDisplay(<span style="color:#2aa198">&#34;WizardArmature&#34;</span>, <span style="color:#2aa198">&#34;BlueWizard&#34;</span>);

wizard<span style="color:#719e07">-&gt;</span>setAnchorPoint(Vec2(<span style="color:#2aa198">0.5</span>,<span style="color:#2aa198">0.5</span>));
wizard<span style="color:#719e07">-&gt;</span>setScale(<span style="color:#2aa198">0.33</span>);
wizard<span style="color:#719e07">-&gt;</span>setPosition(<span style="color:#2aa198">160</span>,<span style="color:#2aa198">140</span>);
addChild(wizard, <span style="color:#2aa198">10</span>);
</code></pre></div><p><a href="https://github.com/beardog-ukr/dragonbones-cocos2dx-v4-demo/blob/master/DemoProj/Classes/dragonBones/cocos2dx/CCArmatureDisplay.h">CCArmatureDisplay</a> is the class for objects you can see on the scene. It&rsquo;s a subclass of <em>Node</em>, so you can do with it anything you used to do with other scene elements.</p>
<p>&ldquo;BlueWizard&rdquo; here is a kind of tag that allows to distinguish this loaded model from all others. The documentation references this parameter as <em>displayName</em>.</p>
<p>&ldquo;WizardArmature&rdquo; is an armature name (<em>armatureName</em>), it was specified in the editor like this:</p>
<figure>
    <img src="/cocos2dx-examples/en/post/dragon-bones-img/db_screen_01a.png"/> 
</figure>

<p>Now if you want to play the animation:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">wizard<span style="color:#719e07">-&gt;</span>getAnimation()<span style="color:#719e07">-&gt;</span>play(<span style="color:#2aa198">&#34;idle01&#34;</span>, <span style="color:#2aa198">1</span>);<span style="color:#586e75">//1 to play animation once
</span></code></pre></div><p>That&rsquo;s how it looks:
<figure>
    <img src="/cocos2dx-examples/en/post/dragon-bones-img/wizard_move.gif"/> 
</figure>
</p>
<p>It&rsquo;s possible to change a part of armature in the program and there are two ways to do it.</p>
<p>First, the editor allows storing few images in one slot. For example, here there are three images in the &ldquo;Gun&rdquo; slot:
<figure>
    <img src="/cocos2dx-examples/en/post/dragon-bones-img/db_screen_02.png"/> 
</figure>
</p>
<p>In this case you can switch to another image simply by specifying index:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#dc322f">int</span> currentWeaponIndex;
<span style="color:#719e07">&lt;</span>....<span style="color:#719e07">&gt;</span>
wizard<span style="color:#719e07">-&gt;</span>getArmature()<span style="color:#719e07">-&gt;</span>getSlot(<span style="color:#2aa198">&#34;Gun&#34;</span>)<span style="color:#719e07">-&gt;</span>setDisplayIndex(currentWeaponIndex);
</code></pre></div><p>Second, you can create a <a href="https://github.com/beardog-ukr/cocos2dx-examples/tree/master/examples/DragonBonesProjects/WeaponPack">special model</a> that will contain only images to be changed. This makes loading and usage more complicated:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">dragonBones<span style="color:#719e07">::</span>CCFactory<span style="color:#719e07">*</span> factory <span style="color:#719e07">=</span> dragonBones<span style="color:#719e07">::</span>CCFactory<span style="color:#719e07">::</span>getFactory();
factory<span style="color:#719e07">-&gt;</span>loadDragonBonesData(<span style="color:#2aa198">&#34;db_export/MagentaKnight_ske.json&#34;</span>, <span style="color:#2aa198">&#34;MagentaKnight&#34;</span>);
factory<span style="color:#719e07">-&gt;</span>loadTextureAtlasData(<span style="color:#2aa198">&#34;db_export/MagentaKnight_tex.json&#34;</span>, <span style="color:#2aa198">&#34;MagentaKnight&#34;</span>);

factory<span style="color:#719e07">-&gt;</span>loadDragonBonesData(<span style="color:#2aa198">&#34;db_export/WeaponPack_ske.json&#34;</span>, <span style="color:#2aa198">&#34;WeaponPackMK&#34;</span>);
factory<span style="color:#719e07">-&gt;</span>loadTextureAtlasData(<span style="color:#2aa198">&#34;db_export/WeaponPack_tex.json&#34;</span>, <span style="color:#2aa198">&#34;WeaponPackMK&#34;</span>);

knight <span style="color:#719e07">=</span> factory<span style="color:#719e07">-&gt;</span>buildArmatureDisplay(<span style="color:#2aa198">&#34;KnightArmature&#34;</span>, <span style="color:#2aa198">&#34;MagentaKnight&#34;</span>);

<span style="color:#719e07">&lt;</span>..later..<span style="color:#719e07">&gt;</span>
factory<span style="color:#719e07">-&gt;</span>replaceSlotDisplay(<span style="color:#2aa198">&#34;WeaponPackMK&#34;</span>, <span style="color:#2aa198">&#34;WeaponPackArmature&#34;</span>, <span style="color:#2aa198">&#34;OneHandWeaponSlot&#34;</span>,
                            <span style="color:#2aa198">&#34;morning_star&#34;</span>, knight<span style="color:#719e07">-&gt;</span>getArmature()<span style="color:#719e07">-&gt;</span>getSlot(<span style="color:#2aa198">&#34;Weapon&#34;</span>));
</code></pre></div><p>Here &ldquo;WeaponPackArmature&rdquo; and &ldquo;OneHandWeaponSlot&rdquo; are the names of armature and slot specified in the model:
<figure>
    <img src="/cocos2dx-examples/en/post/dragon-bones-img/db_screen_03.png"/> 
</figure>
</p>
<p>In both cases result will be the same:
<figure>
    <img src="/cocos2dx-examples/en/post/dragon-bones-img/weapon_change.gif"/> 
</figure>
</p>
		</div>

		<div class="post-tags">
			
				
					<nav class="nav tags">
							<ul class="flat">
								
								<li><a href="/cocos2dx-examples/en/tags/animation">Animation</a></li>
								
								<li><a href="/cocos2dx-examples/en/tags/dragon-bones">Dragon Bones</a></li>
								
								<li><a href="/cocos2dx-examples/en/tags/third-party-tools">third-party tools</a></li>
								
								<li><a href="/cocos2dx-examples/en/tags/skeletal-animation">skeletal animation</a></li>
								
							</ul>
					</nav>
				
			
		</div>
		</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> © public domain |  <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>



<script>feather.replace()</script>
</body>
</html>
