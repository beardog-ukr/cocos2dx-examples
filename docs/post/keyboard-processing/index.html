<!DOCTYPE html>
<html lang="uk">
<head>
  
    <title>Обробка клавіатури :: Основи Cocos2d-x — Про розробку 2d-ігор на Cocos2d-x</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Ще одним прикладом використання макросу CC_CALLBACK може бути робота з клавіатурою.
Для того, щоб додати у програму можливість обробки клавіатури, в init сцени треба додати такий код:
// keyboard processing EventListenerKeyboard* sceneKeyboardListener = EventListenerKeyboard::create(); sceneKeyboardListener-&amp;gt;onKeyPressed = CC_CALLBACK_2(ActionsDemoScene::onKeyPressedScene, this); _eventDispatcher-&amp;gt;addEventListenerWithSceneGraphPriority(sceneKeyboardListener, this); при цьому сама обробка натискання може виглядати так:
void ActionsDemoScene::onKeyPressedScene(EventKeyboard::KeyCode keyCode, Event *event) { printf(&amp;#34;%s: processing key %d pressed\n&amp;#34;, __func__, (int)keyCode); if (EventKeyboard::KeyCode::KEY_A == keyCode) { printf(&amp;#34;%s: key &amp;#39;a&amp;#39; was pressed\n&amp;#34;, __func__); } else { printf(&amp;#34;%s: failed to process." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://beardog-ukr.github.io/cocos2dx-examples/post/keyboard-processing/" />




<link rel="stylesheet" href="https://beardog-ukr.github.io/cocos2dx-examples/assets/style.css">

  <link rel="stylesheet" href="https://beardog-ukr.github.io/cocos2dx-examples/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://beardog-ukr.github.io/cocos2dx-examples/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://beardog-ukr.github.io/cocos2dx-examples/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

<meta name="twitter:creator" content="beardog-ukr" />


<meta property="og:locale" content="uk" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Обробка клавіатури :: Основи Cocos2d-x">
<meta property="og:description" content="Ще одним прикладом використання макросу CC_CALLBACK може бути робота з клавіатурою.
Для того, щоб додати у програму можливість обробки клавіатури, в init сцени треба додати такий код:
// keyboard processing EventListenerKeyboard* sceneKeyboardListener = EventListenerKeyboard::create(); sceneKeyboardListener-&amp;gt;onKeyPressed = CC_CALLBACK_2(ActionsDemoScene::onKeyPressedScene, this); _eventDispatcher-&amp;gt;addEventListenerWithSceneGraphPriority(sceneKeyboardListener, this); при цьому сама обробка натискання може виглядати так:
void ActionsDemoScene::onKeyPressedScene(EventKeyboard::KeyCode keyCode, Event *event) { printf(&amp;#34;%s: processing key %d pressed\n&amp;#34;, __func__, (int)keyCode); if (EventKeyboard::KeyCode::KEY_A == keyCode) { printf(&amp;#34;%s: key &amp;#39;a&amp;#39; was pressed\n&amp;#34;, __func__); } else { printf(&amp;#34;%s: failed to process." />
<meta property="og:url" content="https://beardog-ukr.github.io/cocos2dx-examples/post/keyboard-processing/" />
<meta property="og:site_name" content="Обробка клавіатури" />
<meta property="og:image" content="https://beardog-ukr.github.io/cocos2dx-examples/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-03-27 19:30:25 &#43;0300 &#43;0300" />












</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Основи Cocos2d-x
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/cocos2dx-examples/about">About</a></li>
        
      
        
          <li><a href="/cocos2dx-examples/showcase">Showcase (to be removed)</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/cocos2dx-examples/about">About</a></li>
      
    
      
        <li><a href="/cocos2dx-examples/showcase">Showcase (to be removed)</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://beardog-ukr.github.io/cocos2dx-examples/post/keyboard-processing/">Обробка клавіатури</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2020-03-27
    </span>
    
    
    <span class="post-author">::
      beardog-ukr
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://beardog-ukr.github.io/cocos2dx-examples/tags/keyboard-processing/">keyboard processing</a>&nbsp;
    
    #<a href="https://beardog-ukr.github.io/cocos2dx-examples/tags/cc_callback/">CC_CALLBACK</a>&nbsp;
    
  </span>
  

  

  <div class="post-content"><div>
        <p>Ще одним прикладом використання макросу <code>CC_CALLBACK</code> може бути робота з клавіатурою.</p>
<p>Для того, щоб додати у програму можливість обробки клавіатури, в <code>init</code> сцени треба додати такий код:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">// keyboard processing
</span><span style="color:#75715e"></span>EventListenerKeyboard<span style="color:#f92672">*</span> sceneKeyboardListener <span style="color:#f92672">=</span> EventListenerKeyboard<span style="color:#f92672">::</span>create();
sceneKeyboardListener<span style="color:#f92672">-&gt;</span>onKeyPressed <span style="color:#f92672">=</span> CC_CALLBACK_2(ActionsDemoScene<span style="color:#f92672">::</span>onKeyPressedScene, <span style="color:#66d9ef">this</span>);
_eventDispatcher<span style="color:#f92672">-&gt;</span>addEventListenerWithSceneGraphPriority(sceneKeyboardListener, <span style="color:#66d9ef">this</span>);
</code></pre></div><p>при цьому сама обробка натискання може виглядати так:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">void</span> ActionsDemoScene<span style="color:#f92672">::</span>onKeyPressedScene(EventKeyboard<span style="color:#f92672">::</span>KeyCode keyCode,
                                         Event                 <span style="color:#f92672">*</span>event) {
  printf(<span style="color:#e6db74">&#34;%s: processing key %d pressed</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, __func__, (<span style="color:#66d9ef">int</span>)keyCode);

  <span style="color:#66d9ef">if</span> (EventKeyboard<span style="color:#f92672">::</span>KeyCode<span style="color:#f92672">::</span>KEY_A <span style="color:#f92672">==</span> keyCode) {
    printf(<span style="color:#e6db74">&#34;%s: key &#39;a&#39; was pressed</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, __func__);
  }
  <span style="color:#66d9ef">else</span> {
    printf(<span style="color:#e6db74">&#34;%s: failed to process.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, __func__);
  }
}
</code></pre></div><p>Тобто, спочатку створюється об'єкт класу <a href="https://docs.cocos2d-x.org/api-ref/cplusplus/v4x/df/d2a/classcocos2d_1_1_event_listener_keyboard.html#details">EventListenerKeyboard</a>. Це такий маленький клас, що об'єднує пару вказівників на функції: <code>onKeyPressed</code> та <code>onKeyPressed</code>. Для наших потреб досить буде встановити лише один з них. Ми це робимо, використовуючи макрос <code>CC_CALLBACK_2</code>, тому що метод, який оброблятиме натискання, отримує два параметри.</p>
<p>Потім ми реєструємо новостворений об'єкт у глобальному <a href="https://docs.cocos2d-x.org/api-ref/cplusplus/v4x/d2/d1b/classcocos2d_1_1_event_dispatcher.html">EventDispatcher</a>, який у Cocos2d відповідає за обробку подій.</p>
<p>Теоретично, обробник колбеків зовсім не обов'язково має бути методом сцени. Можна було б реалізувати цю функціональність у якому-небудь іншому класі. Просто це досить зручно, тому що у невеликій програмі саме сцена має доступ до всіх об'єктів, що на ній знаходяться.</p>

      </div></div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Інші пости</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="https://beardog-ukr.github.io/cocos2dx-examples/post/basic-actions/">
          <span class="button__icon">←</span>
          <span class="button__text">Рух та інші перетворення об&#39;єктів</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="https://beardog-ukr.github.io/cocos2dx-examples/post/advanced-callbacks/">
          <span class="button__text">Складніша робота з CC_CALBACK</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://beardog-ukr.github.io/cocos2dx-examples/assets/main.js"></script>
<script src="https://beardog-ukr.github.io/cocos2dx-examples/assets/prism.js"></script>





  
</div>

</body>
</html>
